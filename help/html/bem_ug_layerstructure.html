
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>The layerstructure class</title><meta name="generator" content="MATLAB 9.3"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-02-18"><meta name="DC.source" content="bem_ug_layerstructure.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>The layerstructure class</h1><!--introduction--><p>For particles embedded in layer structures or situated on a substrate, one has to set up a layer structure.  This can be done with the <tt>layerstructure</tt> class.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Initialization</a></li><li><a href="#3">Methods</a></li><li><a href="#5">Implementation</a></li><li><a href="#6">Examples</a></li></ul></div><h2 id="1">Initialization</h2><pre class="codeinput"><span class="comment">%  initialize layer structure</span>
layer = layerstructure( epstab, ind, ztab,     PropertyName, PropertyValue );
layer = layerstructure( epstab, ind, ztab, op, PropertyName, PropertyValue );
</pre><p>In the initialization, the following parameters are used</p><div><ul><li><b><tt>epstab={eps1,eps2,...}</tt></b> is a table of dielectric functions.  This table must be identical to the one used for <tt>comparticle</tt> objects.</li><li><b><tt>ind</tt></b> points for the different layers to the dielectric functions given by the corresponding entries in <tt>epstab</tt>.</li><li><b><tt>ztab</tt></b> is an array for the z-positions of the layer interfaces.</li></ul></div><pre>            eps{ ind( 1 ) }
     --------------------------  z( 1 )
            eps{ ind( 2 ) }
     --------------------------  z( 2 )
                 ...
     --------------------------  z( end )
            eps{ ind( end ) }</pre><p>In addition to the above parameters, one can set the following properties</p><div><ul><li><b><tt>'ztol'</tt></b> boundary elements located closer than <tt>ztol</tt> to the layer interface are considered to belong to the layer.</li><li><b><tt>'rmin'</tt></b> minimum radial distance for Green function tabulation and evalulation.</li><li><b><tt>'zmin'</tt></b> minimum distance to layer for Green function tabulation and evalulation.</li><li><b><tt>'semi'</tt></b> semicircle for evalulation of reflected Green function in complex plane, see M. Paulus et al., PRE <b>62</b>, 5797 (2000).</li><li><b><tt>'ratio'</tt></b> controls whether Bessel or Hankel functions are used in the evalulation of the reflected Green function, see M. Paulus et al.</li><li><b><tt>'op'</tt></b> additional option structure that controls <a href="matlab:doc('ode45')">ode45</a> integration in the complex plane.</li></ul></div><p>For quasistatic simulations only substrates (with one single interface) are allowed.  Once the <tt>layerstructure</tt> object is initialized, it should be added to the MNPBEM option structure</p><pre class="codeinput"><span class="comment">%  add LAYERSTRUCTURE to option structure</span>
op.layer = layer;
</pre><h2 id="3">Methods</h2><p>Layer structurs have a number of <a href="matlab:doc('layerstructure')">methods</a> that are used by the BEM solvers, Green functions and excitation classes. These methods include for retarded simulations</p><pre class="codeinput"><span class="comment">%  set up TABSPACE for tabulated Green functions</span>
tab = tabspace( layer, p, pt );
<span class="comment">%  compute reflected Green functions</span>
[ G, Fr, Fz ] = green( layer, enei, r, z1, z2 );
<span class="comment">%  compute Fresnel coefficients</span>
[ e, k ] = efresnel( layer, pol, dir, enei );
</pre><p>The <tt>tabspace</tt> function will be discussed in more for the <a href="ug_bem_layergreen.html">tabulated Green function</a>.  Details about the reflected Green function and the Fresnel coefficients can be found in the headers of the corresponding files.</p><h2 id="5">Implementation</h2><p>For quasistatic simulations, we employ the method of image charges to compute the reflected Green functions.  For the calculation of the reflected Green functions in the retarded case we use the approach of</p><div><ul><li>M. Paulus et al., Phys. Rev. E <b>62</b>, 5797 (2000).</li></ul></div><p>This approach has been adapted for the potential-based BEM approach for the solution of the full Maxwell equations.</p><h2 id="6">Examples</h2><p>In the first example we set up a substrate with glass and air.  The interface is at z=0.</p><pre class="codeinput"><span class="comment">%  table of dielectric functions (same as for COMPARTICLE object)</span>
epstab = { epsconst( 1 ), epstable( <span class="string">'gold.dat'</span> ), epsconst( 2.25 ) };
<span class="comment">%  interface position</span>
ztab = 0;
<span class="comment">%  default options for layer structure</span>
opt = layerstructure.options;
<span class="comment">%  set up layer structure</span>
layer = layerstructure( epstab, [ 1, 3 ], ztab, opt );
</pre><p>In the second example we consider an additional thin layer with dielectric constant 10 located above the substrate.</p><pre class="codeinput"><span class="comment">%  table of dielectric functions (same as for COMPARTICLE object)</span>
epstab = { epsconst( 1 ), epstable( <span class="string">'gold.dat'</span> ), epsconst( 2.25 ), epsconst( 10 ) };
<span class="comment">%  interface position</span>
ztab = [ 4, 0 ];
<span class="comment">%  default options for layer structure</span>
opts = layerstructure.options;
<span class="comment">%  set up layer structure</span>
layer = layerstructure( epstab, [ 1, 4, 3 ], ztab, opt );
</pre><p>Copyright 2017 Ulrich Hohenester</p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2017b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% The layerstructure class
%
% For particles embedded in layer structures or situated on a substrate,
% one has to set up a layer structure.  This can be done with the
% |layerstructure| class.
%
%% Initialization

%  initialize layer structure
layer = layerstructure( epstab, ind, ztab,     PropertyName, PropertyValue );
layer = layerstructure( epstab, ind, ztab, op, PropertyName, PropertyValue );

%%
% In the initialization, the following parameters are used
%
% * *|epstab={eps1,eps2,...}|* is a table of dielectric functions.  This
% table must be identical to the one used for |comparticle| objects.
% * *|ind|* points for the different layers to the dielectric functions
% given by the corresponding entries in |epstab|.
% * *|ztab|* is an array for the z-positions of the layer interfaces.
% 
%
%              eps{ ind( 1 ) }
%       REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH  z( 1 )
%              eps{ ind( 2 ) }
%       REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH  z( 2 )
%                   ...
%       REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH  z( end )
%              eps{ ind( end ) }
%
%
% In addition to the above parameters, one can set the following properties
%
% * *|'ztol'|* boundary elements located closer than |ztol| to the layer
% interface are considered to belong to the layer.
% * *|'rmin'|* minimum radial distance for Green function tabulation and
% evalulation.
% * *|'zmin'|* minimum distance to layer for Green function tabulation and
% evalulation.
% * *|'semi'|* semicircle for evalulation of reflected Green function in
% complex plane, see M. Paulus et al., PRE *62*, 5797 (2000).
% * *|'ratio'|* controls whether Bessel or Hankel functions are used in the
% evalulation of the reflected Green function, see M. Paulus et al.
% * *|'op'|* additional option structure that controls <matlab:doc('ode45')
% ode45> integration in the complex plane.
%
% For quasistatic simulations only substrates (with one single interface)
% are allowed.  Once the |layerstructure| object is initialized, it should
% be added to the MNPBEM option structure

%  add LAYERSTRUCTURE to option structure
op.layer = layer;

%% Methods
%
% Layer structurs have a number of <matlab:doc('layerstructure') methods>
% that are used by the BEM solvers, Green functions and excitation classes.
% These methods include for retarded simulations

%  set up TABSPACE for tabulated Green functions
tab = tabspace( layer, p, pt );
%  compute reflected Green functions
[ G, Fr, Fz ] = green( layer, enei, r, z1, z2 );
%  compute Fresnel coefficients
[ e, k ] = efresnel( layer, pol, dir, enei );

%%
% The |tabspace| function will be discussed in more for the
% <ug_bem_layergreen.html tabulated Green function>.  Details about the
% reflected Green function and the Fresnel coefficients can be found in the
% headers of the corresponding files.
%
%% Implementation
%
% For quasistatic simulations, we employ the method of image charges to
% compute the reflected Green functions.  For the calculation of the
% reflected Green functions in the retarded case we use the approach of
%
% * M. Paulus et al., Phys. Rev. E *62*, 5797 (2000).
%
% This approach has been adapted for the potential-based BEM approach for
% the solution of the full Maxwell equations.
%
%% Examples
%
% In the first example we set up a substrate with glass and air.  The
% interface is at z=0.

%  table of dielectric functions (same as for COMPARTICLE object)
epstab = { epsconst( 1 ), epstable( 'gold.dat' ), epsconst( 2.25 ) };
%  interface position
ztab = 0;
%  default options for layer structure
opt = layerstructure.options;
%  set up layer structure
layer = layerstructure( epstab, [ 1, 3 ], ztab, opt );

%%
% In the second example we consider an additional thin layer with
% dielectric constant 10 located above the substrate.

%  table of dielectric functions (same as for COMPARTICLE object)
epstab = { epsconst( 1 ), epstable( 'gold.dat' ), epsconst( 2.25 ), epsconst( 10 ) };
%  interface position
ztab = [ 4, 0 ];
%  default options for layer structure
opts = layerstructure.options;
%  set up layer structure
layer = layerstructure( epstab, [ 1, 4, 3 ], ztab, opt );

%%
% 
% Copyright 2017 Ulrich Hohenester
##### SOURCE END #####
--></body></html>